var give_vars;jQuery(document).ready(function(e){function a(a){var i=a.response,o=a.form,_=e("#give-forms-table-notice-wrap");if(_.find(".confirm-fees-notices").remove(),o.find('input[name="give-fee-recovery-settings"]').remove(),"undefined"!=typeof i.fee){_.append('<div class="notice notice-warning confirm-fees-notices"><p> '+i.fee.checkbox+' <label for="give_fee_mode_checkbox" data-feemessage="'+i.fee.message+'" > '+i.fee.message+" </label></p></div>"),"undefined"!=typeof i.fee.hidden&&o.append(i.fee.hidden),n(i.amount,o)}}function i(e){var a=e.response,i=e.form;n(a.amount,i)}function n(e,a){var i=e,n=a.find("#give_fee_percentage").val(),o=a.find("#give_fee_base_amount").val(),_=0;if("undefined"!=typeof i&&""!==i){var t=a.find(".confirm-fees-notices label").data("feemessage");_=give_fee_calculate(give_fee_unformat_amount(n),give_fee_unformat_amount(o),give_fee_unformat_amount(i),!1);var r=t.replace("{fees}",give_fee_format_amount(_,void 0));a.find(".confirm-fees-notices label").text(r)}}function o(e,a){return e=accounting.unformat(e,give_vars.decimal_separator).toString(),a="undefined"!=a&&a,e=!1!==a?parseFloat(e).toFixed(a):parseFloat(e).toFixed(give_vars.currency_decimals)}var _=e('input[name="give_fee_recovery"]:radio'),t=e(".give_fee_all_fields"),r=e('.give-forminp input[name="give_fee_configuration"]:radio'),f=e('.give-forminp input[name="give_fee_mode"]:radio'),v=e(".give-setting-tab-body .give_fee_gateways_fields .give_fee_gateway input:radio"),g=e(".give_fee_all_gateway"),c=e(".give_fee_per_gateway"),d=e(".give_fee_checkbox_label"),s=e(".give_fee_explanation"),u=e("body"),m=e("#give_md_create_payment");m.on("change",'input[name="forms[amount]"], #give_fee_percentage, #give_fee_base_amount',function(){var e=m.find('input[name="forms[amount]"]').val();n(e,m)}),e(document).on("give_md_check_form_setup",a),e(document).on("give_md_variation_change",i),_.on("change",function(){var a=e('input[name="give_fee_recovery"]:radio:checked').val();"enabled"===a?(t.show(),r.change(),f.change(),v.change()):t.hide()}).change(),r.on("change",function(){var a=e('input[name="give_fee_recovery"]:radio:checked').val(),i=e('input[name="give_fee_configuration"]:radio:checked').val();return"enabled"===a&&void("all_gateways"===i?(c.hide(),g.show()):(c.show(),g.hide()))}).change(),f.on("change",function(){var a=e('input[name="give_fee_recovery"]:radio:checked').val(),i=e('input[name="give_fee_mode"]:radio:checked').val();return"enabled"===a&&void(e(".give_fee_mode").is(":visible")&&("donor_opt_in"===i?(d.show(),s.hide()):(d.hide(),s.show())))}).change(),v.on("change",function(){var a=e('input[name="give_fee_recovery"]:radio:checked').val(),i=jQuery(".give_fee_gateways_fields input:radio:checked");return"enabled"===a&&void i.each(function(){var a=e(this),i=a.val();"enabled"===i?(a.closest("fieldset.give_fee_gateway").find(".give_fee_gateway_fee_percentage").show(),a.closest("fieldset.give_fee_gateway").find(".give_fee_gateway_fee_base_amount").show()):(a.closest("fieldset.give_fee_gateway").find(".give_fee_gateway_fee_percentage").hide(),a.closest("fieldset.give_fee_gateway").find(".give_fee_gateway_fee_base_amount").hide())})}).change();var l=e('._form_give_fee_recovery_field input[name="_form_give_fee_recovery"]:radio'),h=e('._form_give_fee_mode_field input[name="_form_give_fee_mode"]:radio'),p=e('._form_give_fee_configuration_field input[name="_form_give_fee_configuration"]:radio'),y=e("#form_fee_options .give_fee_gateways_fields .give_fee_gateway input:radio");l.on("change",function(){var a=e('input[name="_form_give_fee_recovery"]:radio:checked').val();"enabled"===a?(t.show(),h.change(),p.change()):t.hide()}).change(),h.on("change",function(){var a=e('input[name="_form_give_fee_recovery"]:radio:checked').val(),i=e('input[name="_form_give_fee_mode"]:radio:checked').val();return"enabled"===a&&void("donor_opt_in"===i?(d.show(),s.hide()):(d.hide(),s.show()))}).change(),p.on("change",function(){var a=e('input[name="_form_give_fee_recovery"]:radio:checked').val(),i=e('input[name="_form_give_fee_configuration"]:radio:checked').val(),n=e(this);return"enabled"===a&&void("all_gateways"===i?(n.addClass("no-border"),c.hide(),g.show()):(n.removeClass("no-border"),c.show(),g.hide()))}).change(),y.on("change",function(){var a=e('input[name="_form_give_fee_recovery"]:radio:checked').val(),i=e(".give_fee_gateways_fields input:radio:checked");return"enabled"===a&&void i.each(function(a,i){var n=jQuery(i).val(),o=e(this);"enabled"===n?(o.closest(".give_fee_gateway").find(".give_fee_percentage").show(),o.closest(".give_fee_gateway").find(".give_fee_base_amount").show()):(o.closest(".give_fee_gateway").find(".give_fee_percentage").hide(),o.closest(".give_fee_gateway").find(".give_fee_base_amount").hide())})}).change();var w=parseFloat(give_fee_unformat_amount(e("#give-payment-fee-amount").val())),b=parseFloat(give_fee_unformat_amount(e("#give-payment-total").val()));u.on("focusout","#give-payment-fee-amount",function(){var a=e("#give-payment-total"),i=parseFloat(give_fee_unformat_amount(e(this).val())),n=parseFloat(give_fee_unformat_amount(a.val())),o=0,_=give_vars.currency_decimals,t=give_vars.currency_sign;1>=parseInt(_)&&(_=2),give_vars.currency_sign="",w!==i?(i>w?(o=i-w,n=b+o):i<w&&(o=w-i,n=b-o),a.val(give_fee_format_amount(n.toFixed(_)))):a.val(give_fee_format_amount(b.toFixed(_))),give_vars.currency_sign=t});var k=e("#poststuff"),x=give_vars.thousands_separator,F=give_vars.decimal_separator,C="",j="",E="",Q=F===x?1:0;k.on("keyup","input.give-fee-recovery-field",function(){var a="hide";C=(e(this).val().match(new RegExp(x,"g"))||[]).length,j=(e(this).val().match(new RegExp("[a-zA-Z]","g"))||[]).length,a=-1!==e(this).val().indexOf(x)&&Q<C?"show":j?"show":"hide",e(this).giveHintCss(a,{label:give_vars.price_format_guide.trim()}),C=j=""}),k.on("focusout","input.give-fee-recovery-field",function(){var a=give_vars.currency_decimals;1>=parseInt(a)&&(a=2),E=o(e(this).val(),a),E=E.replace(".",F),-1!==E.indexOf("-")&&(E=E.replace("-","")),e(this).giveHintCss("hide",{label:give_vars.price_format_guide.trim()}),e(this).val(E)}),u.on("change","#recount-stats-type",function(){var a=e("option:selected",e(this)).data("type"),i=e("option:selected",e(this)).val();"recount-form"===a&&"Give_Tools_Recount_Form_Fee_Earnings"===i&&(e("#"+a).hide(),e("#recount-form-fee-earnings").show())})});